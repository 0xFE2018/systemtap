#! stap -p2

global foo
probe kernel.function("pipe_writev")
{
   a = $nr_segs
   foo [a] = 1
   # $nr_segs is not an lvalue here (foo is), so this should compile
   # even in non-guru mode
   foo [$nr_segs] ++
}
