set test "profile"
if {![installtest_p]} { untested $test; return }

spawn stap -DMAXMAPENTRIES=10000 $srcdir/$subdir/profile.stp
set ok 0
expect {
    -timeout 360
    -re {kernel.function[^\r]*ttime=[0-9]*\r} { incr ok; exp_continue }
    timeout { fail "$test (timeout)" }
    eof { }
}
#FIXME does not handle case of hanging primes.stp correctly
wait

if {$ok > 0} { pass $test } { fail $test }
