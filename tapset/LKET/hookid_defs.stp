global 
	/* syscall */
	GROUP_SYSCALL,
	HOOKID_SYSCALL_ENTRY, HOOKID_SYSCALL_RETURN, 

	/* process creation */
	GROUP_PROCESS,
	HOOKID_PROCESS_SNAPSHOT, HOOKID_PROCESS_FORK, 
	HOOKID_PROCESS_EXECVE, 

	/* io scheduler */
	GROUP_IOSCHED,
	HOOKID_IOSCHED_NEXT_REQ, HOOKID_IOSCHED_ADD_REQ,
	HOOKID_IOSCHED_REMOVE_REQ,

	/* task dispatching */
	GROUP_TASK,
	HOOKID_TASK_CTXSWITCH, HOOKID_TASK_CPUIDLE,

	/* scsi */
	GROUP_SCSI,
	HOOKID_SCSI_IOENTRY, HOOKID_SCSI_IO_TO_LLD,
	HOOKID_SCSI_IODONE_BY_LLD, HOOKID_SCSI_IOCOMP_BY_MIDLEVEL,

	/* page fault */
	GROUP_PAGEFAULT,
	HOOKID_PAGEFAULT,

	/* network device */
	GROUP_NETDEV,
	HOOKID_NETDEV_RECEIVE, HOOKID_NETDEV_TRANSMIT
%{
/* used in embedded c codes */

/* Group ID Definitions */
int _GROUP_SYSCALL = 1;
int _GROUP_PROCESS = 2;
int _GROUP_IOSCHED = 3;
int _GROUP_TASK = 4;
int _GROUP_SCSI = 5;
int _GROUP_PAGEFAULT = 6;
int _GROUP_NETDEV = 7;

/* hookIDs defined inside each group */
int _HOOKID_SYSCALL_ENTRY = 1;
int _HOOKID_SYSCALL_RETURN = 2;

int _HOOKID_PROCESS_SNAPSHOT = 1;
int _HOOKID_PROCESS_EXECVE = 2;
int _HOOKID_PROCESS_FORK = 3;

int _HOOKID_IOSCHED_NEXT_REQ = 1;
int _HOOKID_IOSCHED_ADD_REQ = 2;
int _HOOKID_IOSCHED_REMOVE_REQ = 3;

int _HOOKID_TASK_CTXSWITCH = 1;
int _HOOKID_TASK_CPUIDLE = 2;

int _HOOKID_SCSI_IOENTRY = 1;
int _HOOKID_SCSI_IO_TO_LLD = 2;
int _HOOKID_SCSI_IODONE_BY_LLD = 3;
int _HOOKID_SCSI_IOCOMP_BY_MIDLEVEL = 4;

int _HOOKID_PAGEFAULT = 1;

int _HOOKID_NETDEV_RECEIVE = 1;
int _HOOKID_NETDEV_TRANSMIT = 2;

%}

probe begin
{
	GROUP_SYSCALL = 1
	HOOKID_SYSCALL_ENTRY = 1
	HOOKID_SYSCALL_RETURN = 2

	GROUP_PROCESS = 2
	HOOKID_PROCESS_SNAPSHOT = 1
 	HOOKID_PROCESS_EXECVE = 2
	HOOKID_PROCESS_FORK = 3

	GROUP_IOSCHED = 3
	HOOKID_IOSCHED_NEXT_REQ = 1
	HOOKID_IOSCHED_ADD_REQ = 2
	HOOKID_IOSCHED_REMOVE_REQ = 3

	GROUP_TASK = 4
	HOOKID_TASK_CTXSWITCH = 1
	HOOKID_TASK_CPUIDLE = 2

	GROUP_SCSI = 5
	HOOKID_SCSI_IOENTRY = 1
	HOOKID_SCSI_IO_TO_LLD = 2
	HOOKID_SCSI_IODONE_BY_LLD = 3
	HOOKID_SCSI_IOCOMP_BY_MIDLEVEL = 4

	GROUP_PAGEFAULT = 6
	HOOKID_PAGEFAULT = 1

	GROUP_NETDEV = 7
	HOOKID_NETDEV_RECEIVE = 1
	HOOKID_NETDEV_TRANSMIT = 2

	lket_trace_init()

	process_snapshot()
}
