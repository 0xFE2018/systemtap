/* utrace-only subset of register accessors */


%{
#include "syscall.h"
%}

function _utrace_syscall_nr:long () %{
   THIS->__retvalue = syscall_get_nr(current, CONTEXT->regs); /* pure */
%}

function _utrace_syscall_arg:long (n:long) %{
   unsigned long arg = 0; /* pure */
   syscall_get_arguments(current, CONTEXT->regs, (int)THIS->n, 1, &arg);
   THIS->__retvalue = arg;
%}

function _utrace_syscall_return:long () %{
   THIS->__retvalue = syscall_get_return_value(current, CONTEXT->regs); /* pure */
%}
