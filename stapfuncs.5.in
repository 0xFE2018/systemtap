.\" -*- nroff -*-
.TH STAPFUNCS 5 @DATE@ "Red Hat"
.SH NAME
stapfuncs \- systemtap functions

.SH DESCRIPTION
The following sections enumerate the public functions provided by
standard tapsets installed under /usr/share/systemtap/tapset.  Each
function is described with a signature, and its behavior/restrictions.
The signature line includes the name of the function, the type of
its return value (if any), and the names and types of all parameters.
The syntax is the same as printed with the 
.IR stap " option " -p2 .
Examples:

.TP
example1:long (v:string, k:long)
Function "example1" does something with the given string and integer.
It returns some integer.

.TP
example2:unknown ()
Function "example2" does something.  There is no explicit return value
and it takes no parameters.

.SS LOGGING

.TP
printk:unknown (msg:string)
Log the given string to the kernel's printk buffer, at KERN_INFO severity.
Append an implicit end-of-line.

.TP
print:unknown (msg:string)
Print the given string to the common trace buffer.

.TP
log:unknown (msg:string)
Log the given string to the common trace buffer.  Append an implicit
end-of-line.

.TP
warn:unknown (msg:string)
Log the given string to the warning stream.  Append an implicit end-of-line.
.I stpd
prepends the string "WARNING:". 

.TP
error:unknown (msg:string)
A fatal error has occurred.  Log the given string to the error stream.
Append an implicit end-of-line.
.I stpd
prepends the string "ERROR:".
Block any further execution of statements in this probe, block
any new probe handlers, and end the systemtap session as soon
as possible.

.TP
exit:unknown ()
Enqueue a request to shut down the systemtap session.  This does
.B not
unwind the current probe handler, nor block new probe handlers.
.I stpd
will shortly respond to the request and initiate an orderly shutdown.

.SS CONVERSIONS

.TP
hexstring:string (num:long)
Return a hexadecimal string representation of the given integer, including
the leading "0x".

.TP
string:string (num:long)
Return a decimal string representation of the given integer.

.TP
kernel_string:string (addr:long)
Copy a string from kernel space at given address.  The validation of this
address is only partial at present.

.TP
user_string:string (addr:long)
Copy a string from user space at given address.  The validation of this
address is only partial at present.

.SS TIMESTAMP

.TP
gettimeofday_ms:long ()
Return the number of milliseconds since the UNIX epoch.

.TP
gettimeofday_s:long ()
Return the number of seconds since the UNIX epoch.

.SS CONTEXTINFO

.TP
execname:string ()
Returns the name of the current process.

.TP
pexecname:string()
Returns the name of the parent process.

.TP
pid:long ()
Returns the current pid. 

.TP
ppid:long ()
Returns the current pid.

.TP
uid:long ()
Returns the uid of the current process.

.TP
euid:long ()
Returns the effective uid of the current process.

.TP
gid:long ()
Returns the gid of the current process.

.TP
egid:long ()
Returns the effective gid of the current process.

.TP
print_regs:unknown ()
Prints a register dump.

.TP
print_backtrace:unknown ()
Prints a symbolic backtrace.  Use with care. May be timeconsuming.

.TP
backtrace:string ()
Returns a string of hex addresses that are a backtrace of the stack.
May be truncated due to maximum string length.

.TP
print_stack(bt:string)
Does a symbolic lookup of the addresses in bt and prints one per line.

.SH FILES
.nh
.IR /usr/share/systemtap/tapset
.hy

.SH SEE ALSO
.IR stap (1)
